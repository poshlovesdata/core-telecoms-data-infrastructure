{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.0rc3", "generated_at": "2025-12-12T08:17:49.905626Z", "invocation_id": "2ed09877-9c3e-43b5-811f-664320be8516", "invocation_started_at": "2025-12-12T08:17:43.502276Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T08:17:49.021498Z", "completed_at": "2025-12-12T08:17:49.025903Z"}, {"name": "execute", "started_at": "2025-12-12T08:17:49.027773Z", "completed_at": "2025-12-12T08:17:49.027796Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.028708219528198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.core_telecoms.stg_social_media", "compiled": true, "compiled_code": "with source as (\n    select * from core_telecom.raw.social_media\n),\n\nrenamed as (\n    select\n        complaint_id,\n        customer_id,\n        agent_id,\n\n        -- Fix source typo 'COMPLAINT_CATEGO_RY'\n        complaint_catego_ry as complaint_category,\n\n        -- Standardize status\n        lower(resolutionstatus) as resolution_status,\n        media_channel,\n\n        -- Map dates\n        request_date as submission_date,\n        resolution_date,\n        mediacomplaintgenerationdate as generated_date,\n\n        _ingested_at,\n        _loaded_at\n    from source\n)\n\nselect * from renamed", "relation_name": "core_telecom.analytics_staging.stg_social_media", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T08:17:49.016672Z", "completed_at": "2025-12-12T08:17:49.026560Z"}, {"name": "execute", "started_at": "2025-12-12T08:17:49.029348Z", "completed_at": "2025-12-12T08:17:49.029359Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030906200408935547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.core_telecoms.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select * from core_telecom.raw.customers\n),\n\nrenamed as (\n    select\n        customer_id,\n        name as customer_name,\n        gender,\n        date_of_birth,\n        signup_date,\n\n        -- Standardize emails to lowercase\n        -- Fix common domain typos (.om - .com, hotmai - hotmail)\n        regexp_replace(\n            regexp_replace(\n                lower(email),\n                '@(gmail|hotmail|yahoo)\\\\.om$', '@\\\\1.com'\n            ),\n            '@hotmai\\\\.com$', '@hotmail.com'\n        ) as email,\n\n        -- Fix multiline addresses (replace newline with space)\n        replace(address, '\\n', ' ') as address,\n\n        _ingested_at,\n        _loaded_at\n    from source\n)\n\nselect * from renamed", "relation_name": "core_telecom.analytics_staging.stg_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T08:17:49.012703Z", "completed_at": "2025-12-12T08:17:49.027137Z"}, {"name": "execute", "started_at": "2025-12-12T08:17:49.030271Z", "completed_at": "2025-12-12T08:17:49.030282Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.033102989196777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.core_telecoms.stg_call_logs", "compiled": true, "compiled_code": "with source as (\n    select * from core_telecom.raw.call_logs\n),\n\nrenamed as (\n    select\n        call_id,\n        customer_id,\n        agent_id,\n\n        -- Fix source typo\n        complaint_catego_ry as complaint_category,\n\n        -- Standardize status\n        lower(resolutionstatus) as resolution_status,\n\n        -- Timestamps\n        call_start_time,\n        call_end_time,\n\n        calllogsgenerationdate as generated_date,\n        _ingested_at,\n        _loaded_at\n    from source\n    -- Filter out potential bad rows where IDs are null\n    where call_id is not null\n)\n\nselect * from renamed", "relation_name": "core_telecom.analytics_staging.stg_call_logs", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T08:17:49.000586Z", "completed_at": "2025-12-12T08:17:49.028749Z"}, {"name": "execute", "started_at": "2025-12-12T08:17:49.031888Z", "completed_at": "2025-12-12T08:17:49.031904Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03706765174865723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.core_telecoms.stg_agents", "compiled": true, "compiled_code": "with source as (\n    select * from core_telecom.raw.agents\n),\n\nrenamed as (\n    select\n        -- Rename messy ID columns to standard 'agent_id'\n        id as agent_id,\n        name as agent_name,\n        experience as experience_level,\n        state,\n\n        _ingested_at,\n        _loaded_at\n    from source\n)\n\nselect * from renamed", "relation_name": "core_telecom.analytics_staging.stg_agents", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T08:17:49.037342Z", "completed_at": "2025-12-12T08:17:49.046759Z"}, {"name": "execute", "started_at": "2025-12-12T08:17:49.051768Z", "completed_at": "2025-12-12T08:17:49.051787Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018047094345092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.core_telecoms.stg_web_forms", "compiled": true, "compiled_code": "with source as (\n    select * from core_telecom.raw.web_forms\n),\n\nrenamed as (\n    select\n        request_id,\n        customer_id,\n        agent_id,\n\n        -- Fix the messy source column name\n        complaint_catego_ry as complaint_category,\n\n        -- Standardize status to lowercase\n        lower(resolutionstatus) as resolution_status,\n\n\n        request_date as submission_date,\n\n        resolution_date,\n\n        -- Rename for readability\n        webformgenerationdate as generated_date,\n\n        _ingested_at,\n        _loaded_at\n    from source\n)\n\nselect * from renamed", "relation_name": "core_telecom.analytics_staging.stg_web_forms", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T08:17:49.042226Z", "completed_at": "2025-12-12T08:17:49.051009Z"}, {"name": "execute", "started_at": "2025-12-12T08:17:49.052890Z", "completed_at": "2025-12-12T08:17:49.052901Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018364906311035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.core_telecoms.dim_customers", "compiled": true, "compiled_code": "with customers as (\n    select * from core_telecom.analytics_staging.stg_customers\n)\n\nselect\n    customer_id,\n    customer_name,\n    gender,\n    date_of_birth,\n    signup_date,\n    email,\n    address,\n\n    -- Calculated Dimensions\n   -- Calculate Customer Tenure\n    datediff('year', date_of_birth, current_date()) as customer_age,\n\n    _ingested_at,\n    _loaded_at\nfrom customers", "relation_name": "core_telecom.analytics_marts.dim_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T08:17:49.047450Z", "completed_at": "2025-12-12T08:17:49.053745Z"}, {"name": "execute", "started_at": "2025-12-12T08:17:49.055412Z", "completed_at": "2025-12-12T08:17:49.055423Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014008283615112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.core_telecoms.dim_agents", "compiled": true, "compiled_code": "with agents as (\n    select * from core_telecom.analytics_staging.stg_agents\n)\n\nselect\n    agent_id,\n    agent_name,\n    experience_level,\n    state as agent_state,\n    _ingested_at,\n    _loaded_at\nfrom agents", "relation_name": "core_telecom.analytics_marts.dim_agents", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T08:17:49.057687Z", "completed_at": "2025-12-12T08:17:49.062206Z"}, {"name": "execute", "started_at": "2025-12-12T08:17:49.062801Z", "completed_at": "2025-12-12T08:17:49.062812Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006570577621459961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.core_telecoms.int_complaints_unioned", "compiled": true, "compiled_code": "with web_forms as (\n    select\n        request_id as complaint_id,\n        customer_id,\n        agent_id,\n        complaint_category,\n        resolution_status,\n        submission_date as complaint_date,\n        resolution_date,\n        'Web Form' as complaint_source,\n        generated_date,\n        _ingested_at,\n        _loaded_at\n    from core_telecom.analytics_staging.stg_web_forms\n),\n\ncall_logs as (\n    select\n        call_id as complaint_id,\n        customer_id,\n        agent_id,\n        complaint_category,\n        resolution_status,\n        call_start_time as complaint_date,\n\n        case\n            when lower(resolution_status) = 'resolved' then call_end_time::date\n            else null\n        end as resolution_date,\n\n        'Call Center' as complaint_source,\n        generated_date,\n        _ingested_at,\n        _loaded_at\n    from core_telecom.analytics_staging.stg_call_logs\n),\n\nsocial_media as (\n    select\n        complaint_id,\n        customer_id,\n        agent_id,\n        complaint_category,\n        resolution_status,\n        submission_date as complaint_date,\n        resolution_date,\n        concat('Social - ', media_channel) as complaint_source,\n        generated_date,\n        _ingested_at,\n        _loaded_at\n    from core_telecom.analytics_staging.stg_social_media\n),\n\nunioned as (\n    select * from web_forms\n    union all\n    select * from call_logs\n    union all\n    select * from social_media\n)\n\nselect\n    *,\n    -- Business Logic: Calculate Resolution Time\n    datediff('day', complaint_date, resolution_date) as resolution_time_days\nfrom unioned", "relation_name": "core_telecom.analytics.int_complaints_unioned", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T08:17:49.068070Z", "completed_at": "2025-12-12T08:17:49.077976Z"}, {"name": "execute", "started_at": "2025-12-12T08:17:49.079216Z", "completed_at": "2025-12-12T08:17:49.079232Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013838529586791992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.core_telecoms.fct_complaints", "compiled": true, "compiled_code": "with complaints as (\n    select * from core_telecom.analytics.int_complaints_unioned\n)\n\nselect\n    complaint_id,\n\n    -- Foreign Keys (Connects to Dims)\n    customer_id,\n    agent_id,\n\n    -- Measures & Attributes\n    complaint_date,\n    complaint_category,\n    complaint_source,\n    resolution_status,\n    resolution_date,\n    resolution_time_days,\n\n    -- Metadata\n    generated_date,\n    _ingested_at\nfrom complaints", "relation_name": "core_telecom.analytics_marts.fct_complaints", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T08:17:49.073320Z", "completed_at": "2025-12-12T08:17:49.078577Z"}, {"name": "execute", "started_at": "2025-12-12T08:17:49.080205Z", "completed_at": "2025-12-12T08:17:49.080215Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014091730117797852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.core_telecoms.int_complaints_enriched", "compiled": true, "compiled_code": "with complaints as (\n    select * from core_telecom.analytics.int_complaints_unioned\n),\n\ncustomers as (\n    select * from core_telecom.analytics_staging.stg_customers\n),\n\nagents as (\n    select * from core_telecom.analytics_staging.stg_agents\n),\n\nenriched as (\n    select\n        -- Key IDs\n        c.complaint_id,\n        c.customer_id,\n        c.agent_id,\n\n        -- Complaint Details\n        c.complaint_date,\n        c.complaint_category,\n        c.complaint_source,\n        c.resolution_status,\n        c.resolution_date,\n        c.resolution_time_days,\n\n        -- Customer Details (Joined)\n        cust.customer_name,\n        cust.email as customer_email,\n        cust.gender,\n        cust.date_of_birth,\n\n        -- Agent Details (Joined)\n        a.agent_name,\n        a.experience_level as agent_experience,\n        a.state as agent_state,\n\n        -- Metadata\n        c._ingested_at\n\n    from complaints c\n    left join customers cust\n        on c.customer_id = cust.customer_id\n    left join agents a\n        on c.agent_id = a.agent_id\n)\n\nselect * from enriched", "relation_name": "core_telecom.analytics.int_complaints_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T08:17:49.083542Z", "completed_at": "2025-12-12T08:17:49.087313Z"}, {"name": "execute", "started_at": "2025-12-12T08:17:49.087902Z", "completed_at": "2025-12-12T08:17:49.087914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005667686462402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.core_telecoms.obt_complaints_overview", "compiled": true, "compiled_code": "with enriched as (\n    select * from core_telecom.analytics.int_complaints_enriched\n)\n\nselect\n    -- All columns from the enriched table\n    *\nfrom enriched", "relation_name": "core_telecom.analytics_marts.obt_complaints_overview", "batch_results": null}], "elapsed_time": 3.9675495624542236, "args": {"vars": {}, "log_level_file": "debug", "version_check": true, "require_unique_project_resource_names": false, "send_anonymous_usage_stats": true, "empty_catalog": false, "use_colors": true, "print": true, "state_modified_compare_more_unrendered_values": false, "write_json": true, "source_freshness_run_project_hooks": true, "indirect_selection": "eager", "populate_cache": true, "cache_selected_only": false, "skip_nodes_if_on_run_start_fails": false, "validate_macro_args": false, "partial_parse_file_diff": true, "log_path": "/home/runner/work/core-telecoms-data-infrastructure/core-telecoms-data-infrastructure/airflow/dbt/logs", "compile": true, "introspect": true, "require_all_warnings_handled_by_warn_error": false, "invocation_command": "dbt docs generate", "log_format_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "partial_parse": true, "require_batched_execution_for_custom_microbatch_strategy": false, "show_resource_report": false, "favor_state": false, "require_nested_cumulative_type_params": false, "defer": false, "require_explicit_package_overrides_for_builtin_materializations": true, "select": [], "use_colors_file": true, "log_file_max_bytes": 10485760, "log_format": "default", "strict_mode": false, "log_level": "info", "exclude": [], "show_all_deprecations": false, "project_dir": "/home/runner/work/core-telecoms-data-infrastructure/core-telecoms-data-infrastructure/airflow/dbt", "quiet": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "printer_width": 80, "require_resource_names_without_spaces": true, "use_fast_test_edges": false, "macro_debugging": false, "static_parser": true, "require_generic_test_arguments_property": true, "state_modified_compare_vars": false, "which": "generate", "profiles_dir": ".", "static": false, "upload_to_artifacts_ingest_api": false}}